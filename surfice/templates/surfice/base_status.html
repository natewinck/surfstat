{% extends "surfice/base.html" %}

{% block title %}Admin | Status{% endblock %}

{% load static %}
{% load humanize %}
{% load slugify %}

{% block body_class %}admin{% endblock %}


{% block nav %}
	{% include "surfice/admin_nav.html" %}
{% endblock %}


{% block heading %}
<!-- JUMBOTRON HEADER
================================================== -->
<div class="container jumbotron jumbotron-admin">
	<h1>Update your Statuses</h1>

	<div class="container">
		<p>Status (n): the position of affairs at a particular time</p>
	</div>
</div>{% endblock heading %} {% block content %} <!-- Start Edit Accordian
==================================================
Each of the <row> act as a different function of the Edit process
-->
<div class="row">
	<div class="container col-xs-offset-2 col-xs-8">
		<!-- Create a Status Section, text details-->

		<div class="row">
			<h3>Create a Status</h3>
		</div>
		
		<form action="" method="post">
			{# To prevent cross-site forgery, include the following required tag #}
			{% csrf_token %}
			<div class="row">
				<div class="col-xs-6">
					<p>New Status Name</p>
					<input name="name" class="form-control" placeholder="Status Name" type="text">
				</div>

				<div class="col-xs-6">
					<p>New Status Description</p>
					<textarea name="description" class="form-control" placeholder="Add Status Description" rows="3"></textarea>
				</div>
			</div><!-- Add color to status, referencing js -->

			<div class="row col-xs-6">
				<p>Assign Status Color</p>
				<div class="input-group">
					<span class="input-group-addon">#</span>
					<input name="data" data-name="color" class="form-control color" placeholder="Status Name" type="text">
				</div>
			</div>

			<div class="row">
				<button class="btn btn-success pull-right button-accordian" type="submit">Add</button>
			</div>
		</form>

		<div class="row">
			<h3>Current Statuses</h3>

			<p>Click to edit status</p>
		</div>

		<div class="row panel-group" id="accordion">
			{% for status in statuses %}
			<div class="panel panel-default">
				<!--Start Panel 1 of Accordian-->

				<div class="panel-heading">
					<h4 class="panel-title"><a data-parent="#accordion" data-target="#status-{{ status.id }}" data-toggle="collapse">{{ status.name }}</a></h4>
				</div>

				<div class="panel-collapse collapse panel-body" id="status-{{ status.id }}">
					<div class="col-xs-12">
						<h3>Edit Your Status</h3>
					</div>
					<form type="ajax" action="ajax/update-status" method="post">
						<div class="row">
							<div class="col-xs-6">
								<p>Update Status Name</p>
								<input name="name" class="form-control" placeholder="Status Name" value="{{ status.name }}" type="text">
							</div>

							<div class="col-xs-6">
								<p>Update Status Description</p>
								<textarea name="description" class="form-control" placeholder="Update Description here..." rows="3">{{ status.description }}</textarea>
							</div>
						</div>

						<div class="row col-xs-4">
							<p>Define Status Color</p>
							<input name="color" value="{{ status.name }}" class="form-control color" placeholder="Text input" type="text">
						</div>
					
						<div class="row">
							<div class="col-xs-offset-6 col-xs-3">
								<button class="btn btn-danger button-accordian pull-right" type="button" data-toggle="modal" data-target="#confirm-delete-status-{{ status.id }}">Delete Status</button>
							</div>

							<div class="col-xs-3">
								<button class="btn btn-success button-accordian pull-right" type="submit">Submit Changes</button>
							</div>
						</div>
					</form>
				</div>
			</div>
			
			
			<div class="modal fade" id="confirm-delete-status-{{ status.id }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<h4 class="modal-title">Confirm Delete</h4>
						</div>
						<form action="" method="post">
							<div class="modal-body">
								<p>
								Are you sure you want to delete the status, {{ status.name }}?
								All surfices assigned with this status will be re-assigned to the below status once this status is deleted.</p>
								<div class="form-group">
									<label class="col-sm-4 control-label" for="new_status">Reassign Surfices to...</label>
									<div class="col-sm-6">
										<select name="new_status" class="form-control">
											<option disabled selected>Select a status...</option>
											{% for newstatus in statuses %}
												{% if newstatus != status %}
												<option value="{{ newstatus.id }}">{{ newstatus.name }}</option>
												{% endif %}
											{% endfor %}
										</select>
									</div>
								</div>
							</div>
							<div class="modal-footer">
								{# To prevent cross-site forgery, include the following required tag #}
								{% csrf_token %}
								<input type="hidden" name="status" value="{{ status.id }}">
								<input type="hidden" name="delete" value="1">
								<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
								<button type="submit" href="#" class="btn btn-danger danger">Delete</button>
							</div>
						</form>
					</div>
				</div>
			</div>
			
			
			{% endfor %}
			
		</div>
	</div>
</div>
<hr class="featurette-divider">
<!-- /END THE FEATURETTES -->

{% endblock content %}

{% block scripts %}<script src="{% static 'surfice/js/jscolor/jscolor.js' %}"></script>{% endblock %}